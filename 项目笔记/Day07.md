# 项目跟进

1. bug修复，按照现在的逻辑，我们可以正常借阅，也可以返回借阅信息，也可以根据读者ID在数据库中查到借阅信息。但是，当我们重启服务器之后，刷新页面，会报一个500错误。说明服务器的逻辑代码是有问题的。根据返回的信息我们可知是BookServlet的doGet方法出了问题。报空指针异常。如图
2. ![image-20200605213322393](https://img.99couple.top/20200605213322.png)
3. 分析后可知，我们的reader信息是保存在session会话中的，当我们服务器重启后，当前会话自然就被销毁，reader也就没了。所以我们需要对当前的登录信息进行判断，加一个过滤器。来判断当前读者是否登录，未登录就重定向到登录界面。但是我们又发现了另外一个问题就是显示借阅信息页面没有分页，所有信息会叠加展示。如图;
4. ![image-20200605215711509](https://img.99couple.top/20200605215711.png)
5. 和所有书的分页逻辑基本一致。我们在Servlet拿到读者id和当前页数，向下传给Service，在Service计算出index和limit（我们这里在Service层写死了成6），再向下传给Repository，Repository根据读者id，index，还有limit去数据库中进行查询。这一项完善后，我们发现我们的BookServlet耦合度过高了，因为在我们在借书请求下产生了两个业务。一个借书，一个查询借阅记录。这也就导致了我们想要单纯的查询借阅记录必须通过借书才能看到当前读者的借阅信息。所以我们要解耦。再添加一个case（也即是method），命名findAllBorrow，并且将此操作绑定到用户名的点击上。也就是读者点击用户名，会跳转到他的借阅信息记录里。
6. 添加注销功能，新建一个LogoutServlet，将session销毁即可，然后跳转到首页。

